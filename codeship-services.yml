companies:
  build:
    image: registry.heroku.com/backend-company/web
    context: ./
    dockerfile: companies.docker
  env_file: .env.prod.encrypted
  cached: true


workspace:
  build:
    image: jincort/backend-company
    context: ./
    args:
      - TZ=UTC
      - INSTALL_XDEBUG=false
    dockerfile: workspace.debug
  tty: true
  links:
    - mongo
    - redis
  volumes_from:
    - src

redis:
  image: jincort/backend-redis:production
  volumes:
      - ./storage/redis:/data

mongo:
  image: jincort/backend-mongodb:production
  volumes:
      - ./storage/mongodb:/data/db
  ports:
    - "27017:27017"
    - "28017:28017"

src:
  image: tianon/true
  volumes:
    - ./:/var/www/companies


dockercfg_generator:
  image: codeship/heroku-dockercfg-generator
  add_docker: true
  encrypted_env_file: deployment.env.encrypted
